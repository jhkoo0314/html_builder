# Rebuild PRD

작성일: 2026-03-01  
문서 버전: v0.1  
대상: `html_builder` 재구축

## 1. 배경
- 현재 시스템은 기능적으로 동작하지만, 보안/운영/확장성 기준에서 프로덕션 표준에 미달한다.
- 재구축 목표는 "동일 기능 + 운영 가능한 품질 + 확장 가능한 구조" 확보이다.

## 2. 문제 정의
- 업로드/프록시 메모리 리스크.
- 인증/인가/레이트리밋 부재.
- 레이어 간 중복 코드와 유지보수 비용 증가.
- 관측성/테스트 자동화 부족.

## 3. 목표
- 문서 업로드 후 HTML 슬라이드 생성 품질 유지 또는 개선.
- 안전한 API 운영 체계 확보.
- 비동기 작업 기반 확장 구조 도입.
- CI/CD와 자동화 테스트 기반의 릴리즈 안정성 확보.

## 4. 비목표
- 초기 재구축에서 멀티 테넌트 과금 시스템 완전 구현.
- 모든 레거시 API 동작을 100% 그대로 유지(핵심 호환만 보장).

## 5. 사용자 시나리오
- 사용자: 문서 업로드 -> 작업 접수 -> 상태 확인 -> 결과 HTML 확인/다운로드.
- 운영자: 장애 감지 -> 원인 파악(로그/메트릭/트레이스) -> 복구.
- 개발자: 로컬 실행 -> 테스트 -> 배포 파이프라인 통과 -> 릴리즈.

## 6. 핵심 요구사항
- 기능:
  - PDF/DOCX/TXT 업로드 지원.
  - Analyze/Render 2-step 파이프라인 유지.
  - 스타일/톤 모드 유지.
- 보안:
  - 인증/인가 적용.
  - 업로드 제한 및 악성 입력 방어.
- 운영:
  - 상태 API, 로그, 메트릭, 알람.
- 품질:
  - 계약 테스트와 회귀 테스트 자동화.

## 7. 성공 지표 (KPI)
- API 접수 P95 < 1.5s
- 작업 성공률 > 98%
- fallback 비율 주간 평균 < 15%
- 무인증 접근 차단율 100%
- 배포 후 롤백률 < 5%

## 8. 릴리즈 범위
- Phase 0: 보안/입력 제한/운영 보호.
- Phase 1: 구조 통합/테스트 체계.
- Phase 2: 비동기 job 아키텍처/관측성 완성.

## 9. 리스크
- LLM 응답 불안정성.
- 문서 파싱 실패 케이스 다양성.
- 레거시와 신규 시스템 병행 기간의 운영 복잡성.

## 10. 승인
- PO:
- Tech Lead:
- QA Lead:

